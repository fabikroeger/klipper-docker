[include v-core3.cfg]
[include steppers.cfg]

[include bltouch.cfg]
[bltouch]
z_offset: 0.0

[include physical-endstops.cfg]
[safe_z_home]
home_xy_position: 200,200 # 400mm printer

[stepper_y]
position_endstop: 400 # 400mm printer

[include 400.cfg]

#[include speed-limits-basic.cfg]
[include speed-limits-performance.cfg]
### EXTRUSION
[include LGX.cfg]
[include mosquito.cfg]
[extruder]
pressure_advance: 0.06

### HOTEND HEATING
# PID Tuning (Remember to run PID tuning before printing)
control: pid
pid_Kp=24.824
pid_Ki=1.947
pid_Kd=79.125

[heater_bed]
control: pid
pid_Kp=57.015
pid_Ki=2.361
pid_Kd=344.227

[include adxl345.cfg]

[include macros.cfg]

[gcode_macro START_PRINT]
gcode:
  SAVE_GCODE_STATE NAME=start_print_state
  G21 ;metric values
  G90 ;absolute positioning
  M82 ;set extruder to absolute mode
  G28 ;home
  M117 Heating...
  M190 S{params.BED_TEMP|default(printer.heater_bed.target, true) }; wait for bed to heat up
  M109 S150 ; Wait for extruder to reach 150 so an inductive probe (if present) is at a predictable temp. Also allows the bed heat to spread a little.
  Z_TILT_ADJUST ;Adjust bed tilt
  G28 Z ;Home again as Z will have changed after tilt adjustment and bed heating.
  BED_MESH_CALIBRATE ; Calibrate bed mesh
  G0 X{printer.toolhead.axis_maximum.x / 2} Y{printer.toolhead.axis_maximum.y} Z50 F6000 ; Park in the back and wait for extruder
  M109 S{params.EXTRUDER_TEMP|default(printer.extruder.target, true) }; wait for extruder to heat up
  M117 Printing...
  RESTORE_GCODE_STATE NAME=start_print_state

# The end_print macro is also called from CANCEL_PRINT.
[gcode_macro END_PRINT]
gcode:
  SAVE_GCODE_STATE NAME=end_print_state
  M104 S0 ;extruder heater off
  M140 S0 ;heated bed heater off
  G91 ;relative positioning
  G1 Z10 E-2 F3600  ;retract the filament a bit before lifting the nozzle.
  G1 E-2 F3600 ;retract filament even more
  G90 ;absolute positioning
  G0 X{printer.toolhead.axis_maximum.x / 2} Y{printer.toolhead.axis_maximum.y} ; Park in the back
  M84 ;steppers off
  M107 ; part cooling fan off
  M117 Done.
  RESTORE_GCODE_STATE NAME=end_print_state

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.079543, -0.033293, -0.023293, -0.013293, -0.010793, -0.008293, -0.007043, -0.009543, -0.025793, -0.015793
#*# 	0.026707, 0.044207, 0.056707, 0.066707, 0.072957, 0.065457, 0.059207, 0.037957, 0.022957, 0.022957
#*# 	0.099207, 0.107957, 0.109207, 0.115457, 0.112957, 0.099207, 0.085457, 0.076707, 0.044207, 0.020457
#*# 	0.095457, 0.114207, 0.105457, 0.106707, 0.106707, 0.101707, 0.092957, 0.077957, 0.049207, 0.019207
#*# 	0.132957, 0.142957, 0.142957, 0.137957, 0.131707, 0.119207, 0.107957, 0.085457, 0.044207, 0.020457
#*# 	0.139207, 0.136707, 0.131707, 0.120457, 0.120457, 0.102957, 0.085457, 0.062957, 0.026707, 0.007957
#*# 	0.131707, 0.131707, 0.099207, 0.096707, 0.104207, 0.084207, 0.065457, 0.036707, -0.003293, -0.030793
#*# 	0.116707, 0.112957, 0.086707, 0.081707, 0.080457, 0.060457, 0.035457, 0.009207, -0.037043, -0.069543
#*# 	0.096707, 0.091707, 0.074207, 0.060457, 0.045457, 0.025457, -0.009543, -0.048293, -0.093293, -0.130793
#*# 	0.065457, 0.060457, 0.050457, 0.037957, 0.024207, -0.012043, -0.049543, -0.089543, -0.137043, -0.174543
#*# tension = 0.2
#*# min_x = 20.0
#*# algo = bicubic
#*# y_count = 10
#*# mesh_y_pps = 2
#*# min_y = 20.0
#*# x_count = 10
#*# max_y = 359.93
#*# mesh_x_pps = 2
#*# max_x = 364.98
#*#
[input_shaper]
shaper_type_x = zv
shaper_freq_x = 70.2
shaper_type_y = mzv
shaper_freq_y = 42.2
